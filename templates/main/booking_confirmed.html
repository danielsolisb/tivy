{% extends 'base.html' %}
{% load static %}

{% block title %}¡Cita Confirmada!{% endblock %}

{% block content %}
{# --- Estilos (similares al paso 3, con colores del negocio si es posible) --- #}
<style>
    :root {
        /* Idealmente, necesitaríamos pasar 'business' al contexto o buscarlo aquí */
        --theme-primary: {{ appointment.business.primary_color|default:'#28a745' }}; /* Verde éxito por defecto */
        --theme-secondary: #f8f9fa;
    }
    body { background-color: var(--theme-secondary); }
    .confirmation-container { max-width: 450px; margin: auto; }
    .confirmation-card { background-color: white; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 2rem; text-align: center; }
    .check-icon { font-size: 4rem; color: var(--theme-primary); margin-bottom: 1rem; }
    .details-card { background-color: #f8f9fa; border-radius: 10px; padding: 1.5rem; text-align: left; margin-top: 1.5rem; margin-bottom: 1.5rem; border: 1px solid #eee;}
    .details-card img { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; margin-right: 1rem; }
    .details-card p { margin-bottom: 0.5rem; color: #555; }
    .details-card strong { color: #333; }
    .action-button { background-color: var(--theme-primary); border: none; color: white; padding: 0.75rem; border-radius: 8px; text-decoration: none; display: block; margin-bottom: 1rem; text-align: center; }
    .action-button:hover { opacity: 0.9; color: white; }
    .secondary-link { color: #555; text-decoration: none; font-size: 0.9rem; }
    .secondary-link:hover { text-decoration: underline; }
    .footer-button { background-color: #e9ecef; border: none; color: #555; padding: 0.75rem; border-radius: 8px; text-decoration: none; display: block; margin-top: 2rem; text-align: center; }
    .footer-button:hover { background-color: #dee2e6; color: #333; }
</style>

<div class="container pt-3 pb-5 confirmation-container">
    <div class="confirmation-card">
        {# Icono de Check (necesitarás Font Awesome o similar) #}
        <div class="check-icon">
             <i class="fas fa-check-circle"></i>
        </div>
        
        <h2>¡Cita confirmada!</h2>
        <p class="text-muted mb-4">Hemos enviado un correo electrónico de confirmación a tu dirección.</p>

        {# --- Resumen Detallado de la Cita --- #}
        <div class="details-card">
             <div class="d-flex align-items-center mb-3">
                 {% if appointment.staff_member.photo %}
                    <img src="{{ appointment.staff_member.photo.url }}" alt="{{ appointment.staff_member.name }}">
                 {% else %}
                     <img src="{% static 'images/default-profile.png' %}" alt="Foto por defecto">
                 {% endif %}
                 <div>
                    <strong class="d-block">{{ appointment.service.name }}</strong>
                    <span class="text-muted">{{ appointment.staff_member.name }}</span>
                 </div>
             </div>
            <p><i class="far fa-calendar-alt me-2 text-muted"></i> <strong>Fecha:</strong> {{ local_start_time|date:"l, d \d\e F" }}</p>
            <p><i class="far fa-clock me-2 text-muted"></i> <strong>Hora:</strong> {{ local_start_time|time:"H:i A" }}</p>
            <p><i class="fas fa-map-marker-alt me-2 text-muted"></i> <strong>Lugar:</strong> {{ appointment.business.address }}</p> {# TODO: Usar dirección del customer si es a domicilio #}
        </div>

        {# --- Botones de Acción --- #}
        <a href="{{ google_calendar_url }}" target="_blank" class="action-button">
            <i class="far fa-calendar-plus me-2"></i> Añadir al calendario
        </a>
        
        <a href="{% url 'reschedule_appointment' pk=appointment.pk %}" class="secondary-link d-block mb-1">
            Reprogramar cita
        </a>
        <p class="text-muted small mb-4">
            Puedes cambiar la hora de tu cita si lo necesitas.
            {# TODO: Añadir lógica/mensaje sobre límite de tiempo si se implementa #}
        </p>
        {# --- Botón para Volver al Inicio --- #}
        <a href="{% url 'business_profile' slug=appointment.business.slug %}" class="footer-button">Volver al Inicio</a>
    </div>
</div>
{% endblock %}